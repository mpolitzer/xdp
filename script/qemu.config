# make suffix match
#CONFIG_LOCALVERSION="-xdplua"
#CONFIG_LOCALVERSION_AUTO=n

# base
CONFIG_BLK_CGROUP=y
CONFIG_GENERIC_SMP_IDLE_THREAD=y
CONFIG_MEMCG=y
CONFIG_MODULE_UNLOAD=y
CONFIG_MODVERSIONS=y
CONFIG_PM_SLEEP_SMP=y
CONFIG_SCHED_SMT=y
CONFIG_SMP=y
CONFIG_X86_64_SMP=y
CONFIG_X86_CPUID=y

CONFIG_BLK_DEV_FD=y
CONFIG_BLK_DEV_RAM=y
CONFIG_CGROUPS=y
CONFIG_DEVTMPFS=y
CONFIG_EPOLL=y
CONFIG_FHANDLE=y
CONFIG_INOTIFY_USER=y
CONFIG_MODULES=y
CONFIG_PROC_FS=y
CONFIG_SIGNALFD=y
CONFIG_SYSFS=y
CONFIG_TIMERFD=y
CONFIG_TMPFS=y

CONFIG_IKCONFIG=y      # keep .config in kernel
CONFIG_IKCONFIG_PROC=y # and expose it via /proc/config.gz

CONFIG_EXT4_FS=y

# podman
CONFIG_OVERLAY_FS=y
CONFIG_OVERLAY_FS_METACOPY=y
CONFIG_FUSE_FS=y
CONFIG_CGROUP_SCHED=y
CONFIG_CGROUP_PIDS=y
CONFIG_CGROUP_RDMA=y
CONFIG_CGROUP_FREEZER=y
CONFIG_CPUSETS=y
CONFIG_CGROUP_DEVICE=y
CONFIG_CGROUP_CPUACCT=y
CONFIG_CGROUP_PERF=y
CONFIG_CGROUP_BPF=y
CONFIG_VETH=y

CONFIG_NETFILTER_XT_MATCH_COMMENT=y
CONFIG_NETFILTER_XT_MATCH_CGROUP=y
CONFIG_NETFILTER_XT_MATCH_BPF=y

CONFIG_TMPFS_XATTR=y
CONFIG_TMPFS_POSIX_ACL=y
CONFIG_TMPFS_INODE64=y
CONFIG_DEVTMPFS_MOUNT=y

# ring-0
CONFIG_BPF_JIT_ALWAYS_ON=y
CONFIG_BPF_SYSCALL=y
CONFIG_LUADATA=y
CONFIG_LUAUNPACK=y
CONFIG_LUAXDP=y
CONFIG_LUNATIK=y
CONFIG_LUNATIK_DEV=y
CONFIG_XDP_LUA=y
CONFIG_XDP_SOCKETS=y

# openvpn
CONFIG_MACVTAP=m
CONFIG_IPVTAP=m
CONFIG_TUN=m
CONFIG_MACVLAN=m
CONFIG_IPVLAN=m

# btf
CONFIG_DEBUG_INFO=y
CONFIG_DEBUG_INFO_REDUCED=y
CONFIG_DEBUG_INFO_COMPRESSED=y
CONFIG_DEBUG_INFO_BTF=y
CONFIG_DEBUG_INFO_DWARF4=y

## gdb
## https://people.freedesktop.org/~narmstrong/meson_drm_doc/dev-tools/gdb-kernel-debugging.html
## https://www.starlab.io/blog/using-gdb-to-debug-the-linux-kernel
# CONFIG_DEBUG_INFO_SPLIT=y
# CONFIG_DEBUG_KERNEL=y
# CONFIG_FRAME_POINTER=y
# CONFIG_GDB_SCRIPTS=y
# CONFIG_KGDB=y
# CONFIG_KGDB_SERIAL_CONSOLE=y
# CONFIG_RANDOMIZE_BASE=n
# CONFIG_DEBUG_INFO_DWARF4=y
CONFIG_KALLSYMS_ALL=y

# net
CONFIG_NET=y
CONFIG_PACKET=y        # tcpdump
CONFIG_UNIX=y          # syslog
CONFIG_XFRM=y
CONFIG_XFRM_ALGO=y
CONFIG_XFRM_USER=y
CONFIG_INET=y
CONFIG_IP_MULTICAST=y
CONFIG_IP_ADVANCED_ROUTER=y
CONFIG_IP_MULTIPLE_TABLES=y
CONFIG_IP_ROUTE_MULTIPATH=y
CONFIG_IP_ROUTE_VERBOSE=y
CONFIG_IP_PNP=y
CONFIG_IP_PNP_DHCP=y
CONFIG_IP_PNP_BOOTP=y
CONFIG_IP_PNP_RARP=y
CONFIG_NET_IP_TUNNEL=y
CONFIG_IP_MROUTE_COMMON=y
CONFIG_IP_MROUTE=y
CONFIG_IP_PIMSM_V1=y
CONFIG_IP_PIMSM_V2=y
CONFIG_SYN_COOKIES=y
CONFIG_INET_TUNNEL=y
CONFIG_TCP_CONG_ADVANCED=y
CONFIG_TCP_CONG_CUBIC=y
CONFIG_DEFAULT_CUBIC=y
CONFIG_DEFAULT_TCP_CONG="cubic"
CONFIG_TCP_MD5SIG=y
CONFIG_IPV6=y
CONFIG_INET6_AH=y
CONFIG_INET6_ESP=y
CONFIG_INET6_XFRM_MODE_TRANSPORT=y
CONFIG_INET6_XFRM_MODE_TUNNEL=y
CONFIG_INET6_XFRM_MODE_BEET=y
CONFIG_IPV6_SIT=y
CONFIG_IPV6_NDISC_NODETYPE=y
CONFIG_NETLABEL=y
CONFIG_NETWORK_SECMARK=y
CONFIG_NET_PTP_CLASSIFY=y
CONFIG_NETFILTER=y

# netfilter
CONFIG_NETFILTER_INGRESS=y
CONFIG_NETFILTER_NETLINK=y
CONFIG_NETFILTER_NETLINK_LOG=y
CONFIG_NF_CONNTRACK=y
CONFIG_NF_LOG_COMMON=m
CONFIG_NF_CONNTRACK_SECMARK=y
CONFIG_NF_CONNTRACK_PROCFS=y
CONFIG_NF_CONNTRACK_FTP=y
CONFIG_NF_CONNTRACK_IRC=y
CONFIG_NF_CONNTRACK_SIP=y
CONFIG_NF_CT_NETLINK=y
CONFIG_NF_NAT=m
CONFIG_NF_NAT_NEEDED=y
CONFIG_NF_NAT_FTP=m
CONFIG_NF_NAT_IRC=m
CONFIG_NF_NAT_SIP=m
CONFIG_NETFILTER_XTABLES=y
CONFIG_NETFILTER_XT_MARK=m
CONFIG_NETFILTER_XT_TARGET_CONNSECMARK=y
CONFIG_NETFILTER_XT_TARGET_LOG=m
CONFIG_NETFILTER_XT_NAT=m
CONFIG_NETFILTER_XT_TARGET_NFLOG=y
CONFIG_NETFILTER_XT_TARGET_SECMARK=y
CONFIG_NETFILTER_XT_TARGET_TCPMSS=y
CONFIG_NETFILTER_XT_MATCH_ADDRTYPE=m
CONFIG_NETFILTER_XT_MATCH_CONNTRACK=y
CONFIG_NETFILTER_XT_MATCH_POLICY=y
CONFIG_NETFILTER_XT_MATCH_STATE=y
CONFIG_NF_DEFRAG_IPV4=y
CONFIG_NF_LOG_ARP=m
CONFIG_NF_LOG_IPV4=m
CONFIG_NF_REJECT_IPV4=y
CONFIG_NF_NAT_IPV4=m
CONFIG_NF_NAT_MASQUERADE_IPV4=y
CONFIG_IP_NF_IPTABLES=y
CONFIG_IP_NF_FILTER=y
CONFIG_IP_NF_TARGET_REJECT=y
CONFIG_IP_NF_NAT=m
CONFIG_IP_NF_TARGET_MASQUERADE=m
CONFIG_IP_NF_MANGLE=y
CONFIG_NF_REJECT_IPV6=y
CONFIG_NF_LOG_IPV6=m
CONFIG_IP6_NF_IPTABLES=y
CONFIG_IP6_NF_MATCH_IPV6HEADER=y
CONFIG_IP6_NF_FILTER=y
CONFIG_IP6_NF_TARGET_REJECT=y
CONFIG_IP6_NF_MANGLE=y
CONFIG_NF_DEFRAG_IPV6=y
CONFIG_HAVE_NET_DSA=y
CONFIG_BRIDGE=y
CONFIG_NET_SCHED=y

# initrd
CONFIG_BLK_DEV_INITRD=y
CONFIG_RD_GZIP=y
CONFIG_RD_BZIP2=n
CONFIG_RD_LZMA=n
CONFIG_RD_XZ=n
CONFIG_RD_LZO=n
CONFIG_RD_LZ4=n

# qemu
CONFIG_ATA=y
CONFIG_CONFIG_I2C=y
CONFIG_CRYPTO_DEV_VIRTIO=y
CONFIG_DEBUG_KERNEL=y
CONFIG_DRM_BOCHS=y
CONFIG_E1000=y
CONFIG_HW_RANDOM=y
CONFIG_HW_RANDOM_VIRTIO=y
CONFIG_HYPERVISOR_GUEST=y
CONFIG_IP_PNP=y
CONFIG_IP_PNP_DHCP=y
CONFIG_KVM_GUEST=y
CONFIG_NETDEVICES=y
CONFIG_PARAVIRT=y
CONFIG_PCI=y
CONFIG_PCI_MSI=y
CONFIG_SERIAL_8250=y
CONFIG_SERIAL_8250_CONSOLE=y
CONFIG_VIRTIO=y
CONFIG_VIRTIO_BALLOON=y
CONFIG_VIRTIO_BLK=y
CONFIG_VIRTIO_CONSOLE=y
CONFIG_VIRTIO_FS=y
CONFIG_VIRTIO_INPUT=y
CONFIG_VIRTIO_NET=y
CONFIG_VIRTIO_PCI=y
CONFIG_VIRTIO_RING=y

# disk?
CONFIG_ATA_GENERIC=y
CONFIG_ATA_PIIX=y
CONFIG_BLK_DEV_DM=y
CONFIG_BLK_DEV_LOOP=y
CONFIG_BLK_DEV_SD=y
CONFIG_BLK_DEV_SR=y
CONFIG_CRYPTO_DEV_VIRTIO=y
CONFIG_EXT4_FS=y
CONFIG_EXT4_FS_POSIX_ACL=y
CONFIG_EXT4_USE_FOR_EXT2=y
CONFIG_FUSE_FS=y
CONFIG_HOTPLUG_PCI=y
CONFIG_ISCSI_TCP=m
CONFIG_ISO9660_FS=y
CONFIG_JOLIET=y
CONFIG_MD=y
CONFIG_MODULE_SRCVERSION_ALL=y
CONFIG_MSDOS_FS=y
CONFIG_NLS_UTF8=y
CONFIG_PATA_ACPI=y
CONFIG_PCIEPORTBUS=y
CONFIG_SATA_AHCI=y
CONFIG_VFAT_FS=y
CONFIG_VHOST_NET=m
CONFIG_VIRTIO_BLK_SCSI=y
CONFIG_XEN_PCIDEV_FRONTEND=y
